(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8303],{3536:(e,r,t)=>{Promise.resolve().then(t.bind(t,72763))},17759:(e,r,t)=>{"use strict";t.d(r,{C5:()=>h,MJ:()=>x,eI:()=>p,lV:()=>o,zB:()=>u});var s=t(95155),a=t(12115),n=t(46057),i=t(29642),l=t(59434),d=t(85057);let o=i.Op,c=a.createContext({}),u=e=>{let{...r}=e;return(0,s.jsx)(c.Provider,{value:{name:r.name},children:(0,s.jsx)(i.xI,{...r})})},m=()=>{let e=a.useContext(c),r=a.useContext(f),{getFieldState:t,formState:s}=(0,i.xW)(),n=t(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=r;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...n}},f=a.createContext({}),p=a.forwardRef((e,r)=>{let{className:t,...n}=e,i=a.useId();return(0,s.jsx)(f.Provider,{value:{id:i},children:(0,s.jsx)("div",{ref:r,className:(0,l.cn)("space-y-2",t),...n})})});p.displayName="FormItem",a.forwardRef((e,r)=>{let{className:t,...a}=e,{error:n,formItemId:i}=m();return(0,s.jsx)(d.J,{ref:r,className:(0,l.cn)(n&&"text-destructive",t),htmlFor:i,...a})}).displayName="FormLabel";let x=a.forwardRef((e,r)=>{let{...t}=e,{error:a,formItemId:i,formDescriptionId:l,formMessageId:d}=m();return(0,s.jsx)(n.DX,{ref:r,id:i,"aria-describedby":a?"".concat(l," ").concat(d):"".concat(l),"aria-invalid":!!a,...t})});x.displayName="FormControl",a.forwardRef((e,r)=>{let{className:t,...a}=e,{formDescriptionId:n}=m();return(0,s.jsx)("p",{ref:r,id:n,className:(0,l.cn)("text-sm text-muted-foreground",t),...a})}).displayName="FormDescription";let h=a.forwardRef((e,r)=>{var t;let{className:a,children:n,...i}=e,{error:d,formMessageId:o}=m(),c=d?String(null!=(t=null==d?void 0:d.message)?t:""):n;return c?(0,s.jsx)("p",{ref:r,id:o,className:(0,l.cn)("text-sm font-medium text-destructive",a),...i,children:c}):null});h.displayName="FormMessage"},36465:(e,r,t)=>{"use strict";t.d(r,{P:()=>c,TH:()=>l,p:()=>o,xY:()=>i,z7:()=>d});var s=t(7334),a=t(56104);let n="deliveryPeople";async function i(e){try{let r=(0,s.H9)(a.db,n,e.uid);await (0,s.BN)(r,{...e,role:"delivery",status:e.status||"pending"})}catch(e){throw console.error("Error adding delivery person: ",e),Error("Could not add the delivery person.")}}async function l(e,r){try{let t=(0,s.H9)(a.db,n,e);await (0,s.mZ)(t,r)}catch(e){throw console.error("Error updating delivery person profile: ",e),Error("Could not update delivery person profile.")}}async function d(){try{return(await (0,s.GG)((0,s.rJ)(a.db,n))).docs.map(e=>({uid:e.id,...e.data()}))}catch(e){throw console.error("Error fetching all delivery people:",e),Error("Could not fetch delivery people.")}}async function o(){try{let e=(0,s.P)((0,s.rJ)(a.db,n),(0,s._M)("status","==","pending"));return(await (0,s.GG)(e)).docs.map(e=>({uid:e.id,...e.data()}))}catch(e){throw console.error("Error fetching pending delivery people:",e),Error("Could not fetch pending delivery people.")}}async function c(e,r){try{let t=(0,s.H9)(a.db,n,e);await (0,s.mZ)(t,{status:r})}catch(e){throw console.error("Error updating delivery person status:",e),Error("Could not update delivery person status.")}}},39401:(e,r,t)=>{"use strict";t.d(r,{Lk:()=>d,P6:()=>o,i7:()=>c,sF:()=>l,yM:()=>i});var s=t(7334),a=t(56104);let n="caterers";async function i(e){try{let r=(0,s.H9)(a.db,n,e.uid);await (0,s.BN)(r,{...e,role:"caterer",status:e.status||"pending"})}catch(e){throw console.error("Error adding caterer: ",e),Error("Could not add the caterer.")}}async function l(e,r){try{let t=(0,s.H9)(a.db,n,e);await (0,s.mZ)(t,r)}catch(e){throw console.error("Error updating caterer profile: ",e),Error("Could not update caterer profile.")}}async function d(){try{let e=(0,s.rJ)(a.db,n);return(await (0,s.GG)(e)).docs.map(e=>({uid:e.id,...e.data()}))}catch(e){throw console.error("Error fetching all caterers: ",e),Error("Could not fetch caterers.")}}async function o(){try{let e=(0,s.P)((0,s.rJ)(a.db,n),(0,s._M)("status","==","pending"));return(await (0,s.GG)(e)).docs.map(e=>({uid:e.id,...e.data()}))}catch(e){throw console.error("Error fetching pending caterers:",e),Error("Could not fetch pending caterers.")}}async function c(e,r){try{let t=(0,s.H9)(a.db,n,e);await (0,s.mZ)(t,{status:r})}catch(e){throw console.error("Error updating caterer status:",e),Error("Could not update caterer status.")}}},56104:(e,r,t)=>{"use strict";let s,a,n,i,l;t.d(r,{IG:()=>i,db:()=>n,hJ:()=>l,j2:()=>a});var d=t(49868),o=t(46151),c=t(7334),u=t(46068);s=0===(0,d.Dk)().length?(0,d.Wp)({apiKey:"AIzaSyDhJXy_8JJ89CUMhj8iyldXvps_H5R7AHI",authDomain:"fithelath.firebaseapp.com",projectId:"fithelath",storageBucket:"fithelath.firebasestorage.app",messagingSenderId:"98685881966",appId:"1:98685881966:web:99d8147fde3b9b5847a07f"}):(0,d.Sx)(),a=(0,o.xI)(s),(0,o.oM)(a,o.F0).catch(e=>{console.error("Firebase persistence error:",e)}),n=(0,c.aU)(s),i=(0,u.c7)(s),l=new o.HF},59434:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var s=t(61219),a=t(6967);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,s.$)(r))}},62523:(e,r,t)=>{"use strict";t.d(r,{p:()=>i});var s=t(95155),a=t(12115),n=t(59434);let i=a.forwardRef((e,r)=>{let{className:t,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...i})});i.displayName="Input"},66695:(e,r,t)=>{"use strict";t.d(r,{BT:()=>c,Wu:()=>u,ZB:()=>o,Zp:()=>l,aR:()=>d});var s=t(95155),a=t(12115),n=t(46057),i=t(59434);let l=a.forwardRef((e,r)=>{let{className:t,as:a="div",asChild:l=!1,...d}=e,o=l?n.DX:a;return(0,s.jsx)(o,{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground",t),...d})});l.displayName="Card";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...a})});d.displayName="CardHeader";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("p",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});c.displayName="CardDescription";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",t),...a})});u.displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},72763:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>T});var s=t(95155),a=t(12115),n=t(35695),i=t(29642),l=t(75288),d=t(52651),o=t(66695),c=t(62523),u=t(85057),m=t(72276),f=t(23901),p=t(59434);let x=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(m.bL,{ref:r,className:(0,p.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,s.jsx)(m.C1,{className:(0,p.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(f.A,{className:"h-4 w-4"})})})});x.displayName=m.bL.displayName;var h=t(87481),v=t(6723),y=t(89215),g=t(10081),N=t(19249),b=t(56104),j=t(7334),w=t(39401),E=t(36465),C=t(17759),S=t(91394);let I=d.Ik({name:d.Yj().min(2,"Le nom est requis."),preferredDeliveryPeople:d.YO(d.Yj()).optional()});function T(){let e=(0,n.useRouter)(),{toast:r}=(0,h.dj)(),[t,d]=(0,a.useState)(!0),[m,f]=(0,a.useState)("idle"),[p,T]=(0,a.useState)(null),[R,A]=(0,a.useState)([]),D=(0,a.useRef)(!1),_=(0,i.mN)({resolver:(0,l.u)(I),defaultValues:{name:"",preferredDeliveryPeople:[]},mode:"onBlur"}),F=(0,a.useCallback)(async e=>{D.current&&d(!0);try{let t=(0,j.H9)(b.db,"caterers",e),s=await (0,j.x7)(t);if(s.exists()&&D.current){let e=s.data();T(e),_.reset({name:e.name,preferredDeliveryPeople:e.preferredDeliveryPeople||[]});let r=(await (0,E.z7)()).filter(r=>r.region===e.region&&"approved"===r.status);A(r)}else r({title:"Erreur",description:"Profil traiteur introuvable.",variant:"destructive"})}catch(e){r({title:"Erreur",description:"Impossible de charger le profil.",variant:"destructive"})}finally{D.current&&d(!1)}},[r,_]);(0,a.useEffect)(()=>{D.current=!0;let r=b.j2.onAuthStateChanged(r=>{r?F(r.uid):e.push("/login")});return()=>{D.current=!1,r()}},[F,e]);let P=async e=>{let t=b.j2.currentUser;if(!t)return;let s=I.safeParse(_.getValues());if(s.success){f("saving");try{await (0,w.sF)(t.uid,s.data),setTimeout(()=>f("saved"),500),setTimeout(()=>f("idle"),2e3)}catch(e){f("idle"),r({title:"Erreur de sauvegarde",description:"Vos modifications n'ont pas pu \xeatre enregistr\xe9es.",variant:"destructive"})}}},k=e=>{_.trigger(e).then(e=>{e&&P(_.getValues())})};return t?(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,s.jsx)(v.A,{className:"h-12 w-12 animate-spin text-primary"})}):(0,s.jsxs)("div",{className:"bg-primary pb-8",children:[(0,s.jsxs)("div",{className:"p-4 pt-8",children:[(0,s.jsx)("div",{className:"flex justify-between items-center text-white mb-6",children:(0,s.jsx)("h1",{className:"text-xl font-bold",children:"MON PROFIL"})}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(S.eu,{className:"h-20 w-20 border-4 border-white/50",children:(0,s.jsx)(S.q5,{children:(0,s.jsx)(y.A,{size:32})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white",children:null==p?void 0:p.name}),(0,s.jsx)("p",{className:"text-white/80 text-sm",children:null==p?void 0:p.email})]})]})]}),(0,s.jsx)(o.Zp,{className:"rounded-t-3xl mt-6",children:(0,s.jsxs)(o.Wu,{className:"p-4 space-y-6",children:[(0,s.jsxs)("div",{className:"h-6 flex items-center justify-center",children:["saving"===m&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrement..."]}),"saved"===m&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-green-600",children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Modifications enregistr\xe9es!"]})]}),(0,s.jsxs)("form",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{htmlFor:"name",children:"Nom du Restaurant"}),(0,s.jsx)(i.xI,{name:"name",control:_.control,render:e=>{let{field:r}=e;return(0,s.jsx)(c.p,{id:"name",...r,onBlur:()=>k("name")})}}),_.formState.errors.name&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:_.formState.errors.name.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{children:"R\xe9gion (non modifiable)"}),(0,s.jsxs)("div",{className:"flex h-10 w-full items-center rounded-md border border-input bg-muted px-3 py-2 text-sm text-muted-foreground gap-2",children:[(0,s.jsx)(N.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"capitalize",children:null==p?void 0:p.region})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.J,{className:"text-lg font-semibold",children:"Mes Livreurs Pr\xe9f\xe9r\xe9s"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"S\xe9lectionnez les livreurs qui apparaissent lors de l'assignation d'une commande."}),R.length>0?(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)(C.zB,{control:_.control,name:"preferredDeliveryPeople",render:e=>{let{field:r}=e;return(0,s.jsx)(s.Fragment,{children:R.map(e=>{var t;return(0,s.jsxs)("div",{className:"flex items-center space-x-3 rounded-md border p-3",children:[(0,s.jsx)(x,{id:"person-".concat(e.uid),checked:null==(t=r.value)?void 0:t.includes(e.uid),onCheckedChange:t=>{let s=t?[...r.value||[],e.uid]:(r.value||[]).filter(r=>r!==e.uid);r.onChange(s),P({preferredDeliveryPeople:s})}}),(0,s.jsxs)(u.J,{htmlFor:"person-".concat(e.uid),className:"flex-1 cursor-pointer",children:[(0,s.jsx)("p",{className:"font-semibold",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground capitalize",children:e.vehicleType})]})]},e.uid)})})}})}):(0,s.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"Aucun livreur approuv\xe9 n'a \xe9t\xe9 trouv\xe9 dans votre r\xe9gion pour le moment."})]})]})]})})]})}},85057:(e,r,t)=>{"use strict";t.d(r,{J:()=>o});var s=t(95155),a=t(12115),n=t(44167),i=t(63999),l=t(59434);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.b,{ref:r,className:(0,l.cn)(d(),t),...a})});o.displayName=n.b.displayName},87481:(e,r,t)=>{"use strict";t.d(r,{dj:()=>m});var s=t(12115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let r=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,r)},l=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?i(t):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},d=[],o={toasts:[]};function c(e){o=l(o,e),d.forEach(e=>{e(o)})}function u(e){let{...r}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function m(){let[e,r]=s.useState(o);return s.useEffect(()=>(d.push(r),()=>{let e=d.indexOf(r);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},91394:(e,r,t)=>{"use strict";t.d(r,{BK:()=>d,eu:()=>l,q5:()=>o});var s=t(95155),a=t(12115),n=t(95419),i=t(59434);let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.bL,{ref:r,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a})});l.displayName=n.bL.displayName;let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n._V,{ref:r,className:(0,i.cn)("aspect-square h-full w-full",t),...a})});d.displayName=n._V.displayName;let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.H4,{ref:r,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a})});o.displayName=n.H4.displayName}},e=>{var r=r=>e(e.s=r);e.O(0,[310,1951,4595,8561,6482,6038,8441,1684,7358],()=>r(3536)),_N_E=e.O()}]);
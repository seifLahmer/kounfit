(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9725],{6844:(e,t,r)=>{"use strict";r.d(t,{$E:()=>c,Cy:()=>u,Hg:()=>i,XT:()=>f,qs:()=>d,rr:()=>l});var a=r(7334),n=r(56104),s=r(46068);let o="meals";async function i(e){try{return(await (0,a.gS)((0,a.rJ)(n.db,o),{...e,ratings:{average:0,count:0},createdAt:(0,a.O5)()})).id}catch(e){throw console.error("Error adding meal: ",e),Error("Could not save the meal.")}}async function l(e,t){let r=(0,a.H9)(n.db,o,e);if(t)try{let e=(0,s.KR)(n.IG,t);await (0,s.XR)(e)}catch(e){"storage/object-not-found"!==e.code&&console.error("Error deleting image from Storage: ",e)}try{await (0,a.kd)(r)}catch(e){throw console.error("Error deleting meal document: ",e),Error("Could not delete the meal.")}}async function d(e){try{let t=(0,a.rJ)(n.db,o),r=(0,a.P)(t,(0,a._M)("createdBy","==",e)),s=await (0,a.GG)(r),i=[];return s.forEach(e=>{let t=e.data();i.push({id:e.id,...t,createdAt:t.createdAt instanceof a.Dc?t.createdAt.toDate():new Date})}),i.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()),i}catch(e){throw console.error("Error fetching meals by caterer: ",e),Error("Could not fetch meals.")}}async function c(e,t){try{let r=(0,a.rJ)(n.db,"caterers"),s=(0,a.P)(r,(0,a._M)("region","==",t),(0,a._M)("status","==","approved")),i=await (0,a.GG)(s);if(i.empty)return[];let l=i.docs.map(e=>e.id),d=[];for(let e=0;e<l.length;e+=10)d.push(l.slice(e,e+10));let c=[];for(let t of d){let r=(0,a.rJ)(n.db,o),s=(0,a.P)(r,(0,a._M)("availability","==",!0),(0,a._M)("category","==",e),(0,a._M)("createdBy","in",t));(await (0,a.GG)(s)).forEach(e=>{let t=e.data();c.push({id:e.id,...t,createdAt:t.createdAt instanceof a.Dc?t.createdAt.toDate():new Date})})}return c.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()),c}catch(e){throw console.error("Error fetching available meals: ",e),Error("Could not fetch available meals.")}}async function u(e){try{let t=(0,a.H9)(n.db,o,e),r=await (0,a.x7)(t);if(!r.exists())return null;let s=r.data();return{id:r.id,...s,createdAt:s.createdAt instanceof a.Dc?s.createdAt.toDate():new Date}}catch(e){throw console.error("Error fetching meal by ID: ",e),Error("Could not fetch the meal.")}}async function f(e){if(!e||0===e.length)return[];try{let t=[];for(let r=0;r<e.length;r+=10)t.push(e.slice(r,r+10));let r=[];for(let e of t){let t=(0,a.rJ)(n.db,o),s=(0,a.P)(t,(0,a._M)((0,a.Fs)(),"in",e));(await (0,a.GG)(s)).forEach(e=>{let t=e.data();r.push({id:e.id,...t,createdAt:t.createdAt instanceof a.Dc?t.createdAt.toDate():new Date})})}return r}catch(e){throw console.error("Error fetching favorite meals: ",e),Error("Could not fetch favorite meals.")}}},7614:(e,t,r)=>{Promise.resolve().then(r.bind(r,72679))},20969:(e,t,r)=>{"use strict";r.d(t,{Kv:()=>c,L$:()=>d,Vd:()=>l,vr:()=>u,wH:()=>i});var a=r(7334),n=r(56104),s=r(22024);let o="orders";async function i(e){let t=(0,a.wP)(n.db);try{let r=[...new Set(e.items.map(e=>e.catererId))],i=e.items.map(e=>({mealId:e.mealId,mealName:e.mealName,quantity:e.quantity,unitPrice:e.unitPrice,catererId:e.catererId,imageUrl:e.imageUrl})),l=e.items.map(e=>{let{mealId:t,mealName:r,quantity:a,unitPrice:n,catererId:s,...o}=e;return o}),d={...e,items:i,status:"pending",orderDate:(0,a.O5)(),deliveryDate:(0,a.O5)(),deliveryTime:35,catererIds:r},c=(0,a.H9)((0,a.rJ)(n.db,o));t.set(c,d);let u=(0,a.H9)(n.db,"users",e.clientId),f=new Date().toISOString().split("T")[0];t.update(u,{["dailyIntake.".concat(f)]:(0,a.hq)(...l)}),await t.commit();let m="Vous avez une nouvelle commande #".concat(c.id.substring(0,5)," de ").concat(e.clientName,".");for(let e of r)await (0,s.UI)(e,m);return c.id}catch(e){throw console.error("Error placing order: ",e),Error("Could not place the order.")}}async function l(){try{let e=(0,a.rJ)(n.db,o),t=(0,a.P)(e,(0,a.My)("orderDate","desc")),r=await (0,a.GG)(t),s=[];return r.forEach(e=>{let t=e.data(),r={id:e.id,...t,orderDate:t.orderDate instanceof a.Dc?t.orderDate.toDate():new Date,deliveryDate:t.deliveryDate instanceof a.Dc?t.deliveryDate.toDate():new Date};s.push(r)}),s}catch(e){throw console.error("Error fetching all orders: ",e),Error("Could not fetch orders.")}}async function d(e){try{let t=(0,a.rJ)(n.db,o),r=(0,a.P)(t,(0,a._M)("catererIds","array-contains",e)),s=await (0,a.GG)(r),i=[];return s.forEach(e=>{let t=e.data(),r={id:e.id,...t,orderDate:t.orderDate instanceof a.Dc?t.orderDate.toDate():new Date,deliveryDate:t.deliveryDate instanceof a.Dc?t.deliveryDate.toDate():new Date};i.push(r)}),i.sort((e,t)=>t.orderDate.getTime()-e.orderDate.getTime()),i}catch(e){throw console.error("Error fetching orders by caterer: ",e),Error("Could not fetch orders.")}}async function c(e,t,r){let i=(0,a.H9)(n.db,o,e);try{let n=await (0,a.x7)(i);if(!n.exists())throw Error("Order not found.");let o=n.data(),l={status:t};"ready_for_delivery"===t&&r&&(l.deliveryPersonId=r),"delivered"===t&&(l.deliveryDate=(0,a.O5)()),await (0,a.mZ)(i,l);let d={in_preparation:"est en cours de pr\xe9paration",ready_for_delivery:"est pr\xeate et a \xe9t\xe9 assign\xe9e \xe0 un livreur.",delivered:"a \xe9t\xe9 livr\xe9e",cancelled:"a \xe9t\xe9 annul\xe9e"};if(t in d){let r="Votre commande #".concat(e.substring(0,5),"... ").concat(d[t],".");await (0,s.UI)(o.clientId,r)}if("ready_for_delivery"===t&&r){let t="Une nouvelle livraison vous a \xe9t\xe9 assign\xe9e : Commande #".concat(e.substring(0,5),"...");await (0,s.UI)(r,t)}}catch(e){throw console.error("Error updating order status: ",e),Error("Could not update the order status.")}}async function u(e,t){if(!t||0===t.length)return[];try{let r=(0,a.rJ)(n.db,o),s=(0,a.P)(r,(0,a._M)("deliveryPersonId","==",e),(0,a._M)("status","in",t)),i=await (0,a.GG)(s),l=[];return i.forEach(e=>{let t=e.data();l.push({id:e.id,...t,orderDate:t.orderDate instanceof a.Dc?t.orderDate.toDate():new Date,deliveryDate:t.deliveryDate instanceof a.Dc?t.deliveryDate.toDate():new Date})}),l.sort((e,t)=>t.orderDate.getTime()-e.orderDate.getTime()),l}catch(e){throw console.error("Error fetching 'my deliveries':",e),Error("Could not fetch assigned deliveries.")}}},22024:(e,t,r)=>{"use strict";r.d(t,{Tr:()=>i,UI:()=>o,bA:()=>l});var a=r(7334),n=r(56104);let s="notifications";async function o(e,t){try{await (0,a.gS)((0,a.rJ)(n.db,s),{userId:e,message:t,isRead:!1,createdAt:(0,a.O5)()})}catch(e){console.error("Error creating notification: ",e)}}async function i(e){try{let t=(0,a.rJ)(n.db,s),r=(0,a.P)(t,(0,a._M)("userId","==",e)),o=await (0,a.GG)(r),i=[];return o.forEach(e=>{let t=e.data();i.push({id:e.id,...t,createdAt:t.createdAt instanceof a.Dc?t.createdAt.toDate():new Date})}),i.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()),i.slice(0,20)}catch(e){throw console.error("Error fetching notifications: ",e),Error("Could not fetch notifications.")}}async function l(e){try{let t=(0,a.H9)(n.db,s,e);await (0,a.mZ)(t,{isRead:!0})}catch(e){throw console.error("Error marking notification as read: ",e),Error("Could not update the notification.")}}},24944:(e,t,r)=>{"use strict";r.d(t,{k:()=>i});var a=r(95155),n=r(12115),s=r(12050),o=r(59434);let i=n.forwardRef((e,t)=>{let{className:r,value:n,indicatorClassName:i,...l}=e;return(0,a.jsx)(s.bL,{ref:t,className:(0,o.cn)("relative h-2 w-full overflow-hidden rounded-full bg-muted",r),...l,children:(0,a.jsx)(s.C1,{className:(0,o.cn)("h-full w-full flex-1 bg-primary transition-all",i),style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});i.displayName=s.bL.displayName},30285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>l});var a=r(95155),n=r(12115),s=r(46057),o=r(63999),i=r(59434);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:o,asChild:d=!1,...c}=e,u=d?s.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:n,size:o,className:r})),ref:t,...c})});d.displayName="Button"},56104:(e,t,r)=>{"use strict";let a,n,s,o,i;r.d(t,{IG:()=>o,db:()=>s,hJ:()=>i,j2:()=>n});var l=r(49868),d=r(46151),c=r(7334),u=r(46068);a=0===(0,l.Dk)().length?(0,l.Wp)({apiKey:"AIzaSyDhJXy_8JJ89CUMhj8iyldXvps_H5R7AHI",authDomain:"fithelath.firebaseapp.com",projectId:"fithelath",storageBucket:"fithelath.firebasestorage.app",messagingSenderId:"98685881966",appId:"1:98685881966:web:99d8147fde3b9b5847a07f"}):(0,l.Sx)(),n=(0,d.xI)(a),(0,d.oM)(n,d.F0).catch(e=>{console.error("Firebase persistence error:",e)}),s=(0,c.aU)(a),o=(0,u.c7)(a),i=new d.HF},59434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var a=r(61219),n=r(6967);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,a.$)(t))}},66695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>u,ZB:()=>d,Zp:()=>i,aR:()=>l});var a=r(95155),n=r(12115),s=r(46057),o=r(59434);let i=n.forwardRef((e,t)=>{let{className:r,as:n="div",asChild:i=!1,...l}=e,d=i?s.DX:n;return(0,a.jsx)(d,{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground",r),...l})});i.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...n})});l.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});d.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...n})});c.displayName="CardDescription";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...n})});u.displayName="CardContent",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter"},72679:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>W});var a=r(95155),n=r(12115),s=r(66766),o=r(66695),i=r(30285),l=r(24944),d=r(35213),c=r(69199),u=r(3774),f=r(59434);let m={light:"",dark:".dark"},h=n.createContext(null);function p(){let e=n.useContext(h);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let g=n.forwardRef((e,t)=>{let{id:r,className:s,children:o,config:i,...l}=e,c=n.useId(),u="chart-".concat(r||c.replace(/:/g,""));return(0,a.jsx)(h.Provider,{value:{config:i},children:(0,a.jsxs)("div",{"data-chart":u,ref:t,className:(0,f.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",s),...l,children:[(0,a.jsx)(v,{id:u,config:i}),(0,a.jsx)(d.u,{children:o})]})})});g.displayName="Chart";let v=e=>{let{id:t,config:r}=e,n=Object.entries(r).filter(e=>{let[,t]=e;return t.theme||t.color});return n.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(m).map(e=>{let[r,a]=e;return"\n".concat(a," [data-chart=").concat(t,"] {\n").concat(n.map(e=>{var t;let[a,n]=e,s=(null==(t=n.theme)?void 0:t[r])||n.color;return s?"  --color-".concat(a,": ").concat(s,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null};c.m;let x=n.forwardRef((e,t)=>{let{active:r,payload:s,className:o,indicator:i="dot",hideLabel:l=!1,hideIndicator:d=!1,label:c,labelFormatter:u,labelClassName:m,formatter:h,color:g,nameKey:v,labelKey:x}=e,{config:b}=p(),w=n.useMemo(()=>{var e;if(l||!(null==s?void 0:s.length))return null;let[t]=s,r="".concat(x||t.dataKey||t.name||"value"),n=y(b,t,r),o=x||"string"!=typeof c?null==n?void 0:n.label:(null==(e=b[c])?void 0:e.label)||c;return u?(0,a.jsx)("div",{className:(0,f.cn)("font-medium",m),children:u(o,s)}):o?(0,a.jsx)("div",{className:(0,f.cn)("font-medium",m),children:o}):null},[c,u,s,l,m,b,x]);if(!r||!(null==s?void 0:s.length))return null;let j=1===s.length&&"dot"!==i;return(0,a.jsxs)("div",{ref:t,className:(0,f.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",o),children:[j?null:w,(0,a.jsx)("div",{className:"grid gap-1.5",children:s.map((e,t)=>{let r="".concat(v||e.name||e.dataKey||"value"),n=y(b,e,r),s=g||e.payload.fill||e.color;return(0,a.jsx)("div",{className:(0,f.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:h&&(null==e?void 0:e.value)!==void 0&&e.name?h(e.value,e.name,e,t,e.payload):(0,a.jsxs)(a.Fragment,{children:[(null==n?void 0:n.icon)?(0,a.jsx)(n.icon,{}):!d&&(0,a.jsx)("div",{className:(0,f.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":j&&"dashed"===i}),style:{"--color-bg":s,"--color-border":s}}),(0,a.jsxs)("div",{className:(0,f.cn)("flex flex-1 justify-between leading-none",j?"items-end":"items-center"),children:[(0,a.jsxs)("div",{className:"grid gap-1.5",children:[j?w:null,(0,a.jsx)("span",{className:"text-muted-foreground",children:(null==n?void 0:n.label)||e.name})]}),e.value&&(0,a.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});function y(e,t,r){if("object"!=typeof t||null===t)return;let a="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,n=r;return r in t&&"string"==typeof t[r]?n=t[r]:a&&r in a&&"string"==typeof a[r]&&(n=a[r]),n in e?e[n]:e[r]}x.displayName="ChartTooltip",u.s,n.forwardRef((e,t)=>{let{className:r,hideIcon:n=!1,payload:s,verticalAlign:o="bottom",nameKey:i}=e,{config:l}=p();return(null==s?void 0:s.length)?(0,a.jsx)("div",{ref:t,className:(0,f.cn)("flex items-center justify-center gap-4","top"===o?"pb-3":"pt-3",r),children:s.map(e=>{let t="".concat(i||e.dataKey||"value"),r=y(l,e,t);return(0,a.jsxs)("div",{className:(0,f.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==r?void 0:r.icon)&&!n?(0,a.jsx)(r.icon,{}):(0,a.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==r?void 0:r.label]},e.value)})}):null}).displayName="ChartLegend";var b=r(40954),w=r(61151),j=r(21544),D=r(94427),N=r(48665),E=r(6723),k=r(84082),_=r(55267),A=r(8051),S=r(20969),I=r(6844),C=r(56104),T=r(87481),M=r(413),O=r(70576),R=r(20598),P=r(92850),G=r(49675),J=r(47160),U=r(9287),H=r(58295),L=r(36334),F=r(59171);let K={revenue:{label:"Revenue",color:"hsl(var(--destructive))"}},Z=e=>{let t=new Date,r=(0,M.w)(t),a=(0,O.p)(t),n=(0,M.w)((0,R.a)(t,1)),s=(0,O.p)((0,R.a)(t,1)),o=0,i=0;e.filter(e=>"delivered"===e.status).forEach(e=>{let t=e.orderDate.toDate?e.orderDate.toDate():new Date(e.orderDate);t>=r&&t<=a&&(o+=e.totalPrice),t>=n&&t<=s&&(i+=e.totalPrice)});let l=i>0?(o-i)/i*100:100*(o>0);return{currentMonthRevenue:o,percentageChange:l}},q=(e,t)=>{let r=e.filter(e=>"delivered"===e.status),a=new Date;if("month"===t){let e=(0,M.w)(a),t=(0,O.p)(a),n={};return r.forEach(r=>{let a=r.orderDate.toDate?r.orderDate.toDate():new Date(r.orderDate);if(a>=e&&a<=t){let e=(0,P.N)(a);n[e]||(n[e]=0),n[e]+=r.totalPrice}}),Object.entries(n).map(e=>{let[t,r]=e;return{name:"Sem ".concat(t),value:r}}).sort((e,t)=>e.name.localeCompare(t.name))}if("week"===t){let e=(0,G.k)(a,{weekStartsOn:1}),t=(0,J.$)(a,{weekStartsOn:1}),n=(0,U.k)({start:e,end:t}),s={};return n.forEach(e=>{s[(0,H.GP)(e,"yyyy-MM-dd")]=0}),r.forEach(r=>{let a=r.orderDate.toDate?r.orderDate.toDate():new Date(r.orderDate);if(a>=e&&a<=t){let e=(0,H.GP)(a,"yyyy-MM-dd");s[e]+=r.totalPrice}}),Object.entries(s).map(e=>{let[t,r]=e;return{name:(0,H.GP)((0,L.H)(t),"eee",{locale:F.fr}),value:r}})}return[]},z=(e,t)=>{let r={},a=new Set(t.map(e=>e.id));return e.forEach(e=>{e.items.forEach(e=>{a.has(e.mealId)&&(r[e.mealId]?r[e.mealId]+=e.quantity:r[e.mealId]=e.quantity)})}),Object.keys(r).sort((e,t)=>r[t]-r[e]).slice(0,5).map(e=>{let a=t.find(t=>t.id===e);return{id:e,name:(null==a?void 0:a.name)||"Repas inconnu",image:(null==a?void 0:a.imageUrl)||"https://placehold.co/40x40.png",count:r[e]}})},B=e=>[...e].filter(e=>e.ratings&&e.ratings.count>0).sort((e,t)=>{var r,a;return((null==(r=t.ratings)?void 0:r.average)||0)-((null==(a=e.ratings)?void 0:a.average)||0)}).slice(0,5);function W(){let[e,t]=(0,n.useState)("month"),[r,u]=(0,n.useState)(!0),{toast:f}=(0,T.dj)(),[m,h]=(0,n.useState)([]),[p,v]=(0,n.useState)(0),[y,M]=(0,n.useState)(0),[O,R]=(0,n.useState)([]),[P,G]=(0,n.useState)([]),[J,U]=(0,n.useState)([]),[H,L]=(0,n.useState)([]);(0,n.useEffect)(()=>{(async()=>{let e=C.j2.currentUser;if(!e){f({title:"Erreur",description:"Utilisateur non connect\xe9.",variant:"destructive"}),u(!1);return}u(!0);try{let[t,r]=await Promise.all([(0,S.L$)(e.uid),(0,I.qs)(e.uid)]);U(t),L(r);let{currentMonthRevenue:a,percentageChange:n}=Z(t);v(a),M(n),R(z(t,r)),G(B(r))}catch(e){f({title:"Erreur",description:"Impossible de charger les statistiques.",variant:"destructive"})}finally{u(!1)}})()},[f]),(0,n.useEffect)(()=>{h(q(J,e))},[J,e]);let F=(0,n.useMemo)(()=>O.reduce((e,t)=>e+t.count,0),[O]);return r?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen bg-background",children:(0,a.jsx)(E.A,{className:"h-12 w-12 animate-spin text-primary"})}):(0,a.jsxs)("div",{className:"bg-primary",children:[(0,a.jsxs)("header",{className:"p-4 pt-8 text-white bg-gradient-to-br from-primary via-primary to-background/30",children:[(0,a.jsx)(s.default,{src:"/kounfit/kounfit-white.png",alt:"Kounfit Logo",width:100,height:25}),(0,a.jsx)("h1",{className:"text-3xl font-bold font-serif mt-2",children:"Statistiques"})]}),(0,a.jsxs)("main",{className:"bg-background rounded-t-3xl p-4 space-y-6",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(o.ZB,{children:"Chiffre d'affaires"}),(0,a.jsxs)("div",{className:"flex items-center gap-1 bg-muted p-1 rounded-full",children:[(0,a.jsx)(i.$,{size:"sm",variant:"week"===e?"default":"ghost",onClick:()=>t("week"),className:"rounded-full h-8 px-4",children:"7 jours"}),(0,a.jsx)(i.$,{size:"sm",variant:"month"===e?"default":"ghost",onClick:()=>t("month"),className:"rounded-full h-8 px-4",children:"Mois"})]})]})}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsx)("div",{className:"h-48 w-full",children:(0,a.jsx)(g,{config:K,children:(0,a.jsx)(d.u,{width:"100%",height:"100%",children:(0,a.jsxs)(b.b,{data:m,margin:{top:5,right:10,left:-30,bottom:0},children:[(0,a.jsx)(w.d,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--border))"}),(0,a.jsx)(j.W,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:12}}),(0,a.jsx)(D.h,{axisLine:!1,tickLine:!1,tick:{fill:"hsl(var(--muted-foreground))",fontSize:12}}),(0,a.jsx)(c.m,{content:(0,a.jsx)(x,{hideIndicator:!0}),cursor:{stroke:"hsl(var(--destructive))",strokeWidth:2,strokeDasharray:"3 3"}}),(0,a.jsx)(N.N,{type:"monotone",dataKey:"value",stroke:"hsl(var(--destructive))",strokeWidth:3,dot:!1})]})})})}),(0,a.jsxs)("div",{className:"flex items-baseline gap-4 mt-4",children:[(0,a.jsxs)("p",{className:"text-3xl font-bold",children:[p.toFixed(2)," DT"]}),0!==y&&(0,a.jsxs)("div",{className:"flex items-center font-semibold ".concat(y>=0?"text-green-500":"text-red-500"),children:[y>=0?(0,a.jsx)(k.A,{className:"w-4 h-4"}):(0,a.jsx)(_.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[Math.abs(y).toFixed(1),"%"]})]})]})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Repas les plus command\xe9s"})}),(0,a.jsx)(o.Wu,{className:"space-y-4",children:O.length>0?O.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(s.default,{src:e.image,alt:e.name,width:40,height:40,className:"rounded-md","data-ai-hint":"caterer meal"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsx)(l.k,{value:e.count/(F||1)*100,className:"h-2 mt-1",indicatorClassName:"bg-primary"})]}),(0,a.jsx)("p",{className:"font-semibold",children:e.count})]},e.name)):(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"Aucune commande pour le moment."})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Repas les mieux not\xe9s"})}),(0,a.jsx)(o.Wu,{className:"space-y-4",children:P.length>0?P.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(s.default,{src:e.imageUrl,alt:e.name,width:40,height:40,className:"rounded-md","data-ai-hint":"caterer meal"}),(0,a.jsx)("p",{className:"flex-1 font-medium",children:e.name}),(0,a.jsx)("div",{className:"flex items-center",children:Array.from({length:5}).map((t,r)=>{var n;return(0,a.jsx)(A.A,{className:"w-5 h-5 ".concat(r<((null==(n=e.ratings)?void 0:n.average)||0)?"text-yellow-400 fill-yellow-400":"text-gray-300")},r)})})]},e.id)):(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"Vos repas n'ont pas encore \xe9t\xe9 not\xe9s."})})]})]})]})}},87481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>f});var a=r(12115);let n=0,s=new Map,o=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=i(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=a.useState(d);return a.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[310,1951,4595,8561,6766,5547,8295,1566,8441,1684,7358],()=>t(7614)),_N_E=e.O()}]);
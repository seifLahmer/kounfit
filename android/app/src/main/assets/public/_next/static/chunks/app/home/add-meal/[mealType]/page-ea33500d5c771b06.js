(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2232],{6723:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(31291).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6844:(e,t,r)=>{"use strict";r.d(t,{$E:()=>d,Cy:()=>u,Hg:()=>n,XT:()=>f,qs:()=>c,rr:()=>l});var a=r(7334),s=r(56104),o=r(46068);let i="meals";async function n(e){try{return(await (0,a.gS)((0,a.rJ)(s.db,i),{...e,ratings:{average:0,count:0},createdAt:(0,a.O5)()})).id}catch(e){throw console.error("Error adding meal: ",e),Error("Could not save the meal.")}}async function l(e,t){let r=(0,a.H9)(s.db,i,e);if(t)try{let e=(0,o.KR)(s.IG,t);await (0,o.XR)(e)}catch(e){"storage/object-not-found"!==e.code&&console.error("Error deleting image from Storage: ",e)}try{await (0,a.kd)(r)}catch(e){throw console.error("Error deleting meal document: ",e),Error("Could not delete the meal.")}}async function c(e){try{let t=(0,a.rJ)(s.db,i),r=(0,a.P)(t,(0,a._M)("createdBy","==",e)),o=await (0,a.GG)(r),n=[];return o.forEach(e=>{let t=e.data();n.push({id:e.id,...t,createdAt:t.createdAt instanceof a.Dc?t.createdAt.toDate():new Date})}),n.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()),n}catch(e){throw console.error("Error fetching meals by caterer: ",e),Error("Could not fetch meals.")}}async function d(e,t){try{let r=(0,a.rJ)(s.db,"caterers"),o=(0,a.P)(r,(0,a._M)("region","==",t),(0,a._M)("status","==","approved")),n=await (0,a.GG)(o);if(n.empty)return[];let l=n.docs.map(e=>e.id),c=[];for(let e=0;e<l.length;e+=10)c.push(l.slice(e,e+10));let d=[];for(let t of c){let r=(0,a.rJ)(s.db,i),o=(0,a.P)(r,(0,a._M)("availability","==",!0),(0,a._M)("category","==",e),(0,a._M)("createdBy","in",t));(await (0,a.GG)(o)).forEach(e=>{let t=e.data();d.push({id:e.id,...t,createdAt:t.createdAt instanceof a.Dc?t.createdAt.toDate():new Date})})}return d.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()),d}catch(e){throw console.error("Error fetching available meals: ",e),Error("Could not fetch available meals.")}}async function u(e){try{let t=(0,a.H9)(s.db,i,e),r=await (0,a.x7)(t);if(!r.exists())return null;let o=r.data();return{id:r.id,...o,createdAt:o.createdAt instanceof a.Dc?o.createdAt.toDate():new Date}}catch(e){throw console.error("Error fetching meal by ID: ",e),Error("Could not fetch the meal.")}}async function f(e){if(!e||0===e.length)return[];try{let t=[];for(let r=0;r<e.length;r+=10)t.push(e.slice(r,r+10));let r=[];for(let e of t){let t=(0,a.rJ)(s.db,i),o=(0,a.P)(t,(0,a._M)((0,a.Fs)(),"in",e));(await (0,a.GG)(o)).forEach(e=>{let t=e.data();r.push({id:e.id,...t,createdAt:t.createdAt instanceof a.Dc?t.createdAt.toDate():new Date})})}return r}catch(e){throw console.error("Error fetching favorite meals: ",e),Error("Could not fetch favorite meals.")}}},22346:(e,t,r)=>{"use strict";r.d(t,{w:()=>n});var a=r(95155),s=r(12115),o=r(75638),i=r(59434);let n=s.forwardRef((e,t)=>{let{className:r,orientation:s="horizontal",decorative:n=!0,...l}=e;return(0,a.jsx)(o.b,{ref:t,decorative:n,orientation:s,className:(0,i.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",r),...l})});n.displayName=o.b.displayName},24987:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(31291).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},31291:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(12115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u,...f}=e;return(0,a.createElement)("svg",{ref:t,...i,width:s,height:s,stroke:r,strokeWidth:l?24*Number(n)/Number(s):n,className:o("lucide",c),...f},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),l=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{className:l,...c}=r;return(0,a.createElement)(n,{ref:i,iconNode:t,className:o("lucide-".concat(s(e)),l),...c})});return r.displayName="".concat(e),r}},35695:(e,t,r)=>{"use strict";var a=r(18999);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},48610:(e,t,r)=>{Promise.resolve().then(r.bind(r,78960))},55401:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(31291).A)("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]])},56104:(e,t,r)=>{"use strict";let a,s,o,i,n;r.d(t,{IG:()=>i,db:()=>o,hJ:()=>n,j2:()=>s});var l=r(49868),c=r(46151),d=r(7334),u=r(46068);a=0===(0,l.Dk)().length?(0,l.Wp)({apiKey:"AIzaSyDhJXy_8JJ89CUMhj8iyldXvps_H5R7AHI",authDomain:"fithelath.firebaseapp.com",projectId:"fithelath",storageBucket:"fithelath.firebasestorage.app",messagingSenderId:"98685881966",appId:"1:98685881966:web:99d8147fde3b9b5847a07f"}):(0,l.Sx)(),s=(0,c.xI)(a),(0,c.oM)(s,c.F0).catch(e=>{console.error("Firebase persistence error:",e)}),o=(0,d.aU)(a),i=(0,u.c7)(a),n=new c.HF},56673:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(31291).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},62523:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var a=r(95155),s=r(12115),o=r(59434);let i=s.forwardRef((e,t)=>{let{className:r,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},63999:(e,t,r)=>{"use strict";r.d(t,{F:()=>i});var a=r(61219);let s=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,o=a.$,i=(e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return o(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:n}=t,l=Object.keys(i).map(e=>{let t=null==r?void 0:r[e],a=null==n?void 0:n[e];if(null===t)return null;let o=s(t)||s(a);return i[e][o]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{});return o(e,l,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:r,className:a,...s}=t;return Object.entries(s).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...n,...c}[t]):({...n,...c})[t]===r})?[...e,r,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},66695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>u,ZB:()=>c,Zp:()=>n,aR:()=>l});var a=r(95155),s=r(12115),o=r(46057),i=r(59434);let n=s.forwardRef((e,t)=>{let{className:r,as:s="div",asChild:n=!1,...l}=e,c=n?o.DX:s;return(0,a.jsx)(c,{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground",r),...l})});n.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...s})});l.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...s})});d.displayName="CardDescription";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...s})});u.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},70048:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(31291).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},75638:(e,t,r)=>{"use strict";r.d(t,{b:()=>c});var a=r(12115),s=r(77868),o=r(95155),i="horizontal",n=["horizontal","vertical"],l=a.forwardRef((e,t)=>{var r;let{decorative:a,orientation:l=i,...c}=e,d=(r=l,n.includes(r))?l:i;return(0,o.jsx)(s.sG.div,{"data-orientation":d,...a?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...c,ref:t})});l.displayName="Separator";var c=l},77868:(e,t,r)=>{"use strict";r.d(t,{hO:()=>l,sG:()=>n});var a=r(12115),s=r(47650),o=r(46057),i=r(95155),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,o.TL)(`Primitive.${t}`),s=a.forwardRef((e,a)=>{let{asChild:s,...o}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(s?r:t,{...o,ref:a})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function l(e,t){e&&s.flushSync(()=>e.dispatchEvent(t))}},78960:(e,t,r)=>{"use strict";r.d(t,{default:()=>E});var a=r(95155),s=r(12115),o=r(35695),i=r(66766),n=r(55401),l=r(56673),c=r(85807),d=r(70048),u=r(24987),f=r(6723),h=r(30285),p=r(66695),m=r(62523),v=r(6844),y=r(88468),x=r(56104),g=r(87481),b=r(59434),w=r(13262),j=r(22346),A=r(7334);let N={breakfast:"Petit d\xe9jeuner",lunch:"D\xe9jeuner",dinner:"D\xeener",snack:"Collation"},k=e=>{let{meals:t,favoriteMealIds:r,onToggleFavorite:s,showAddButton:o=!0,onAddMeal:d}=e;return 0===t.length?(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-8",children:[(0,a.jsx)(n.A,{className:"w-12 h-12 mx-auto mb-2"}),(0,a.jsx)("p",{children:"Aucun repas trouv\xe9 dans cette section."})]}):(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:t.map(e=>(0,a.jsxs)(p.Zp,{as:"div",className:"relative block overflow-hidden rounded-2xl border shadow-sm h-56 group",children:[(0,a.jsx)(i.default,{src:e.imageUrl,alt:e.name,layout:"fill",objectFit:"cover",className:"w-full h-full transition-transform duration-300 group-hover:scale-105","data-ai-hint":"healthy food"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),(0,a.jsx)(p.Wu,{className:"relative z-10 p-3 flex flex-col justify-end h-full text-white",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-base truncate",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)(w.DL,{className:"w-3 h-3 text-primary"}),(0,a.jsxs)("span",{className:"font-medium text-sm",children:[e.calories," kcal"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs mt-1",children:[(0,a.jsx)("span",{className:"font-semibold text-protein",children:"P"}),(0,a.jsxs)("span",{children:[e.macros.protein,"g"]}),(0,a.jsx)("span",{className:"font-semibold text-primary",children:"C"}),(0,a.jsxs)("span",{children:[e.macros.carbs,"g"]}),(0,a.jsx)("span",{className:"font-semibold text-fat",children:"F"}),(0,a.jsxs)("span",{children:[e.macros.fat,"g"]})]})]})}),(0,a.jsx)("div",{className:"absolute top-2 right-2 z-20",children:(0,a.jsx)(h.$,{variant:"ghost",size:"icon",className:"text-white/80 hover:text-white",onClick:t=>{t.preventDefault(),t.stopPropagation(),s(e.id)},children:(0,a.jsx)(l.A,{className:(0,b.cn)("w-6 h-6",r.includes(e.id)?"text-red-500 fill-current":"text-white")})})}),o&&d&&(0,a.jsx)("div",{className:"absolute bottom-2 right-2 z-20",children:(0,a.jsx)(h.$,{size:"icon",className:"bg-primary/80 hover:bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center shrink-0",onClick:t=>{t.preventDefault(),t.stopPropagation(),d(e)},children:(0,a.jsx)(c.A,{className:"w-5 h-5"})})})]},e.id))})};function E(){let e=(0,o.useRouter)(),t=(0,o.useParams)(),r=Array.isArray(t.mealType)?t.mealType[0]:t.mealType,[i,n]=(0,s.useState)([]),[l,c]=(0,s.useState)({breakfast:[],lunch:[],snack:[],dinner:[]}),[p,b]=(0,s.useState)([]),[w,E]=(0,s.useState)(!0),[S,D]=(0,s.useState)(""),{toast:C}=(0,g.dj)(),[T,I]=(0,s.useState)([]),[M,O]=(0,s.useState)(null),R=(0,s.useCallback)(()=>{let e=x.j2.currentUser;if(!e)return{breakfast:[],lunch:[],snack:[],dinner:[]};try{let t=localStorage.getItem("dailyPlanData_".concat(e.uid));if(t){let{date:e,plan:r}=JSON.parse(t);if(e===new Date().toISOString().split("T")[0])return{breakfast:Array.isArray(r.breakfast)?r.breakfast:[],lunch:Array.isArray(r.lunch)?r.lunch:[],snack:Array.isArray(r.snack)?r.snack:[],dinner:Array.isArray(r.dinner)?r.dinner:[]}}}catch(e){console.error("Failed to parse daily plan from storage",e)}return{breakfast:[],lunch:[],snack:[],dinner:[]}},[]),_=(0,s.useCallback)(async e=>{try{if(null==e?void 0:e.region){let t=await (0,v.$E)(r,e.region);n(t)}else C({title:"R\xe9gion non d\xe9finie",description:"Veuillez d\xe9finir votre r\xe9gion dans votre profil pour voir les repas disponibles.",variant:"destructive"})}catch(e){C({title:"Erreur",description:"Impossible de charger les repas disponibles.",variant:"destructive"})}},[r,C]);(0,s.useEffect)(()=>{let t=x.j2.currentUser;if(!t)return void e.push("/login");E(!0);let r=new Date().toISOString().split("T")[0],a=(0,A.H9)(x.db,"users",t.uid),s=(0,A.aQ)(a,e=>{if(e.exists()){var t;let a=e.data();O(a),I(a.favoriteMealIds||[]),b((null==(t=a.dailyIntake)?void 0:t[r])||[]),_(a)}else C({title:"Erreur",description:"Profil non trouv\xe9.",variant:"destructive"});E(!1)}),o=()=>{c(R())};return window.addEventListener("storage",o),o(),()=>{s(),window.removeEventListener("storage",o)}},[e,C,_,R]);let P=async e=>{if(M)try{let t=await (0,y.Of)(M.uid,e);I(t);let r=t.includes(e);C({title:r?"Ajout\xe9 aux favoris":"Retir\xe9 des favoris",description:"Le repas a \xe9t\xe9 ".concat(r?"ajout\xe9 \xe0":"retir\xe9 de"," vos favoris.")})}catch(e){C({title:"Erreur",description:"Impossible de mettre \xe0 jour les favoris.",variant:"destructive"})}},F=(0,s.useMemo)(()=>{let e=[...p.filter(e=>e&&e.category===r),...l[r]||[]],t={};return e.forEach(e=>{e&&(t[e.id]=e)}),Object.values(t)},[p,l,r]),z=(0,s.useMemo)(()=>i.filter(e=>e.name.toLowerCase().includes(S.toLowerCase())),[i,S]),L=(0,s.useMemo)(()=>F.filter(e=>e.name.toLowerCase().includes(S.toLowerCase())),[F,S]);return(0,a.jsxs)("div",{className:"flex flex-col h-screen bg-gradient-to-b from-[#a2fcdc] to-background",children:[(0,a.jsx)("header",{className:"p-4 space-y-4 sticky top-0 bg-transparent backdrop-blur-sm z-10",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>e.back(),className:"shrink-0",children:(0,a.jsx)(d.A,{})}),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(u.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,a.jsx)(m.p,{type:"text",placeholder:"Rechercher un ".concat(N[r]||"repas","..."),className:"pl-10 h-12 rounded-button bg-gray-50 border-gray-200 focus:bg-white",value:S,onChange:e=>D(e.target.value)})]})]})}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24",children:w?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(f.A,{className:"h-8 w-8 animate-spin text-primary"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Repas Ajout\xe9s"}),(0,a.jsx)(k,{meals:L,favoriteMealIds:T,onToggleFavorite:P,showAddButton:!1})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(j.w,{className:"flex-1"}),(0,a.jsx)("h2",{className:"text-xl font-bold whitespace-nowrap",children:"Repas Recommand\xe9s"}),(0,a.jsx)(j.w,{className:"flex-1"})]}),(0,a.jsx)("div",{children:(0,a.jsx)(k,{meals:z,favoriteMealIds:T,onAddMeal:e=>{let t=x.j2.currentUser;if(!t)return void C({title:"Non connect\xe9",description:"Veuillez vous connecter pour ajouter un repas.",variant:"destructive"});try{let r="dailyPlanData_".concat(t.uid),a=R(),s=e.category;Array.isArray(a[s])||(a[s]=[]),a[s].push(e);let o=new Date().toISOString().split("T")[0];localStorage.setItem(r,JSON.stringify({date:o,plan:a})),c(a),C({title:"Repas ajout\xe9 !",description:"".concat(e.name," a \xe9t\xe9 ajout\xe9 \xe0 votre plan.")})}catch(e){C({title:"Erreur",description:"Impossible d'ajouter le repas au plan.",variant:"destructive"}),console.error("Failed to update localStorage",e)}},onToggleFavorite:P})})]})})]})}},85807:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(31291).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},87481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>f});var a=r(12115);let s=0,o=new Map,i=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=n(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=a.useState(c);return a.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},88468:(e,t,r)=>{"use strict";r.d(t,{Of:()=>c,VM:()=>l,eg:()=>n,hE:()=>u,jS:()=>d});var a=r(7334),s=r(56104),o=r(46151);let i="users";async function n(e,t){try{let r=(0,a.H9)(s.db,i,e),o=await (0,a.x7)(r),n={};Object.keys(t).forEach(e=>{let r=t[e];void 0!==r&&(n[e]=r)}),delete n.role;let l={...n,uid:e,role:"client",updatedAt:(0,a.O5)(),...o.exists()?{}:{createdAt:(0,a.O5)()}};await (0,a.BN)(r,l,{merge:!0})}catch(e){throw console.error("Error in updateUserProfile: ",e),Error("Failed to update user profile: ".concat(e))}}async function l(e){try{if(!e)return null;let t=(0,a.H9)(s.db,i,e),r=await (0,a.x7)(t);if(!r.exists())return null;{let e=r.data();return e.createdAt&&e.createdAt instanceof a.Dc&&(e.createdAt=e.createdAt.toDate()),e.updatedAt&&e.updatedAt instanceof a.Dc&&(e.updatedAt=e.updatedAt.toDate()),e}}catch(e){throw console.error("Could not fetch user profile.",e),Error("Could not fetch user profile.")}}async function c(e,t){let r=(0,a.H9)(s.db,i,e);try{let e,s=await (0,a.x7)(r);if(!s.exists())throw Error("User profile not found.");let o=s.data().favoriteMealIds||[];return o.includes(t)?(await (0,a.mZ)(r,{favoriteMealIds:(0,a.C3)(t)}),e=o.filter(e=>e!==t)):(await (0,a.mZ)(r,{favoriteMealIds:(0,a.hq)(t)}),e=[...o,t]),e}catch(e){throw console.error("Error toggling favorite meal: ",e),Error("Could not update favorites.")}}async function d(){try{let e=(0,a.rJ)(s.db,i);return(await (0,a.d_)(e)).data().count}catch(e){throw console.error("Error getting user count: ",e),Error("Could not get user count.")}}async function u(e){try{await (0,o.J1)(s.j2,e)}catch(e){throw console.error("Error sending password reset email: ",e),Error("Failed to send password reset email.")}}}},e=>{var t=t=>e(e.s=t);e.O(0,[310,1951,4595,8561,6766,2678,8441,1684,7358],()=>t(48610)),_N_E=e.O()}]);